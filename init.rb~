require 'redmine'

Redmine::Plugin.register :redmine_secretary do
  name 'Redmine Secretary plugin'
  author 'Roman Shipiev'
  description 'Plugin for the registration of incoming and outgoing documents'
  version '0.0.1'
  url 'http://github.com/rubynovich/redmine_secretary'
  author_url 'http://roman.shipiev.me'
  
  permission :view_incoming_letters,  :incoming_letters => [:index, :show]
  permission :add_incoming_letters,   :incoming_letters => [:new, :create]
  permission :edit_incoming_letters,  :incoming_letters => [:edit, :update]
  permission :view_outgoing_letters,  :outgoing_letters => [:index, :show]
  permission :add_outgoing_letters,   :outgoing_letters => [:new, :create]
  permission :edit_outgoing_letters,  :outgoing_letters => [:edit, :update]  
  
  menu :application_menu, :incoming_letters, {:controller => :incoming_letters, :action => :index}, :caption => :incoming, :param => :project_id, :if => Proc.new{User.current.allowed_to?({:controller => :incoming_letters, :action => :index}, nil, {:global => false})}
  menu :application_menu, :outgoing_letters, {:controller => :outgoing_letters, :action => :index}, :caption => :outgoing, :param => :project_id, :if => Proc.new{ User.current.allowed_to?({:controller => :outgoing_letters, :action => :index}, nil, {:global => false})}
end
